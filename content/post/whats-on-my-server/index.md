---
title: "我的服务器近况介绍"
date: 2023-12-23T09:38:00+08:00
draft: false
image: "server01.webp"
tags: ["服务器"]
categories: ["技术"]
---

介绍一下我的服务器当前的状况：服务器硬件是E5洋垃圾，详细配置参见[在家折腾服务器的经过——系统搭建和测试跑分](/post/server-01)；系统是Windows Server 2022 Standard，使用Hyper-V创建了四台Linux虚拟机，分别运行本博客、网盘、Git和VS Code Server。

此前我的各种服务主要运行在Windows Server系统内，主要是比较习惯图形界面。但熟悉了命令行之后我发现很多服务在Linux服务器上配置要简单和省事许多，而且Linux系统的性能占用也较少，我的64GB内存和12核CPU可以轻松实现多开虚拟机，将不同的服务隔离开来。

下面分别介绍一下我目前各种东西的解决方案，首先是域名注册。起初我选择的是Gandi，但后来被它堪称黑心的价格劝退了。现在使用的是Dynadot，感觉还很不错，一个.com域名一年只需要$10多一点，DNSSEC什么的也是免费的，同时附带一个免费邮箱。我的个人邮箱clf3@clf3.org和天依邮箱tianyi@tianyi.moe现在就都是托管在Dynadot上的。

然后是DNS和CDN，这方面我选择的是Cloudflare，当然目前我主要只使用了它的DNS解析和页面规则（设置301跳转）。因为Cloudflare的CDN在中国大陆堪称减速器，许多运营商都会把发往Cloudflare的请求绕到美国的节点，延迟丢包都巨高。这里点名表扬CERNET，它可以直连CF的香港节点，延迟30ms左右（点名批评中国联通，实在想不明白绕这么远的路对它自己有什么好处）。

再说一下DDNS。由于我使用的是家庭宽带，公网IP会时常变动（具体是大约每七天运营商断线重拨一次），因此需要一个DDNS的脚本来实时改变域名（主要是clf3.org及其子域名）的解析。此前我使用的是自己写的一个Python脚本，但功能不是很完善，且配置起来比较麻烦。恰好我的一个室友用Rust写了一个[使用Cloudflare API进行DDNS的脚本](https://github.com/un-lock-able/cloudflare-ddns-rust)，经过多次改进后现在我用起来效果还不错，修改配置也很方便。

网络方面，由于家庭宽带的IPv4地址都会封掉80、443端口，只有v6地址的80、443不会被封。为了实现v4、v6双栈访问，我使用了一台日本东京的VPS进行反代，将v4的HTTPS流量通过v6转发到我家里的服务器，速度和延迟都也还可以，我们家到日本东京这台VPS延迟只有大约80ms。

然后是TLS证书，这里我选择的是Let’s encrypt，主要是因为免费。而且Let’s encrypt官方有一个用来自动更新证书的脚本Certbot，使用起来还比较方便。目前我在我所有的服务器上均使用*.clf3.org的通配符证书，有效期三个月。

博客方面我使用的就是你们现在看到的WordPress。我对博客的要求本身也不是很高，有一个可以写一些文字的地方也就很够用了。WP的好处在于操作比较傻瓜式，模板和插件也相对较多。但缺点就是基本上要跟着模板走，有些东西没法自定义，而且对代码的支持也不太好。

网盘我使用的是ownCloud社区版，我的ownCloud运行在一个单独的虚拟机中，这个虚拟机独占一组RAID1阵列，磁盘空间为1200GB。ownCloud的界面还算简洁美观，功能也比较全，webDAV、同步软件和手机APP都有。但是同步软件和手机APP使用体验极差，似乎它们的同步机制存在某些问题，经常有文件被上传两次，甚至发生冲突无法继续上传。不过网页端和webDAV目前使用都还比较正常。

Git服务我使用的是Gitea，体验还是不错的，Github能实现的功能它也基本都能实现。美中不足的有两点：一是无法使用SSH，只能用HTTPS。因为正如上文提到的，我的所有网站的v4访问都是通过转发实现的，而SSH没有主机名，无法实现按域名的转发。二是不能实现可视化查看分支，Github的insight项中有一个network功能，可以可视化地查看不同分支之间的关系，但Gitea目前没有这个功能。

此外，为了实现随时随地写代码，我在服务器上还部署了一个Code Server，也就是一个网页版的VS Code。这样无论在哪里，使用什么设备，只要能联网，就能使用服务器上的环境进行开发。这个项目是Github上的一个开源项目，链接在[这里](https://github.com/coder/code-server)。

接下来我打算学习Vue，从头开始自己写一个使用Vue前端+Django后端的网站。这个网站主要会分享一些中V相关的资源，将使用tianyi.moe这个域名（可能还有tianyiblue.com）。